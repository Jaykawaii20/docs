"use strict";(self.webpackChunkdocument_management=self.webpackChunkdocument_management||[]).push([[279],{3279:(nt,f,n)=>{n.r(f),n.d(f,{CompanyProfileModule:()=>tt});var S=n(6895),l=n(4006),m=n(2340),y=n(2676),t=n(4650),s=n(8988),_=n(1076),C=n(7185),A=n(3023),Z=n(6107),b=n(5485),x=n(9785),g=n(3546),u=n(3848),v=n(1572),p=n(8796),T=n(9383);function F(e,r){if(1&e&&t._UZ(0,"img",36),2&e){const o=t.oxw(2);t.Q6J("src",o.imgSrc,t.LSH)}}function P(e,r){1&e&&t._UZ(0,"img",37)}function L(e,r){if(1&e&&t._UZ(0,"img",36),2&e){const o=t.oxw(2);t.Q6J("src",o.bannerSrc,t.LSH)}}function U(e,r){1&e&&t._UZ(0,"img",38)}const h=function(){return["/dashboard"]};function I(e,r){if(1&e){const o=t.EpF();t.TgZ(0,"mat-tab",13),t.ALo(1,"translate"),t.TgZ(2,"div",14)(3,"div",15)(4,"div",4)(5,"form",16)(6,"div",4)(7,"div",17)(8,"div",8)(9,"label",18),t._uU(10),t.ALo(11,"translate"),t.qZA(),t._UZ(12,"input",19),t.qZA(),t.TgZ(13,"div",8)(14,"div",20)(15,"label",21),t._uU(16),t.ALo(17,"translate"),t.qZA(),t.TgZ(18,"mat-card",22)(19,"input",23,24),t.NdJ("change",function(i){t.CHM(o);const c=t.oxw();return t.KtG(c.onFileSelect(i))}),t.qZA(),t.YNc(21,F,1,1,"img",25),t.YNc(22,P,1,0,"img",26),t.TgZ(23,"mat-card-actions")(24,"button",27),t.NdJ("click",function(){t.CHM(o);const i=t.MAs(20);return t.KtG(i.click())}),t._UZ(25,"i",28),t._uU(26),t.ALo(27,"translate"),t.qZA()()()()()(),t.TgZ(28,"div",17)(29,"label",21),t._uU(30),t.ALo(31,"translate"),t.qZA(),t.TgZ(32,"mat-card",22)(33,"input",23,29),t.NdJ("change",function(i){t.CHM(o);const c=t.oxw();return t.KtG(c.onBannerChange(i))}),t.qZA(),t.YNc(35,L,1,1,"img",25),t.YNc(36,U,1,0,"img",30),t.TgZ(37,"mat-card-actions")(38,"button",27),t.NdJ("click",function(){t.CHM(o);const i=t.MAs(34);return t.KtG(i.click())}),t._UZ(39,"i",28),t._uU(40),t.ALo(41,"translate"),t.qZA()()()(),t.TgZ(42,"div",31)(43,"button",32),t.NdJ("click",function(){t.CHM(o);const i=t.oxw();return t.KtG(i.saveCompanyProfile())}),t._UZ(44,"i",33),t._uU(45),t.ALo(46,"translate"),t.qZA(),t.TgZ(47,"button",34),t._UZ(48,"i",35),t._uU(49),t.ALo(50,"translate"),t.qZA()()()()()()()()}if(2&e){const o=t.oxw();t.s9C("label",t.lcZ(1,14,"GENERAL")),t.xp6(5),t.Q6J("formGroup",o.companyProfileForm),t.xp6(5),t.Oqu(t.lcZ(11,16,"TITLE")),t.xp6(6),t.Oqu(t.lcZ(17,18,"LOGO")),t.xp6(5),t.Q6J("ngIf",o.imgSrc),t.xp6(1),t.Q6J("ngIf",!o.imgSrc),t.xp6(4),t.hij(" ",t.lcZ(27,20,"CHANGE_LOGO"),""),t.xp6(4),t.Oqu(t.lcZ(31,22,"BANNER_IMAGE")),t.xp6(5),t.Q6J("ngIf",o.bannerSrc),t.xp6(1),t.Q6J("ngIf",!o.bannerSrc),t.xp6(4),t.hij(" ",t.lcZ(41,24,"CHANGE_BANNER"),""),t.xp6(5),t.hij(" ",t.lcZ(46,26,"SAVE"),""),t.xp6(2),t.Q6J("routerLink",t.DdM(30,h)),t.xp6(2),t.hij(" ",t.lcZ(50,28,"CANCEL"),"")}}function N(e,r){1&e&&(t.TgZ(0,"div",50),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"REQUIRED_FIELD")," "))}function E(e,r){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,N,3,3,"div",49),t.qZA()),2&e){const o=t.oxw(3);t.xp6(1),t.Q6J("ngIf",null==o.localStorageForm.get("amazonS3key").errors?null:o.localStorageForm.get("amazonS3key").errors.required)}}function z(e,r){1&e&&(t.TgZ(0,"div",50),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"REQUIRED_FIELD")," "))}function q(e,r){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,z,3,3,"div",49),t.qZA()),2&e){const o=t.oxw(3);t.xp6(1),t.Q6J("ngIf",null==o.localStorageForm.get("amazonS3secret").errors?null:o.localStorageForm.get("amazonS3secret").errors.required)}}function J(e,r){1&e&&(t.TgZ(0,"div",50),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"REQUIRED_FIELD")," "))}function V(e,r){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,J,3,3,"div",49),t.qZA()),2&e){const o=t.oxw(3);t.xp6(1),t.Q6J("ngIf",null==o.localStorageForm.get("amazonS3region").errors?null:o.localStorageForm.get("amazonS3region").errors.required)}}function k(e,r){1&e&&(t.TgZ(0,"div",50),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"REQUIRED_FIELD")," "))}function R(e,r){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,k,3,3,"div",49),t.qZA()),2&e){const o=t.oxw(3);t.xp6(1),t.Q6J("ngIf",null==o.localStorageForm.get("amazonS3bucket").errors?null:o.localStorageForm.get("amazonS3bucket").errors.required)}}function O(e,r){if(1&e&&(t.TgZ(0,"div",4)(1,"div",17)(2,"label",18),t._uU(3),t.ALo(4,"translate"),t.qZA(),t._UZ(5,"input",44),t.YNc(6,E,2,1,"div",45),t.qZA(),t.TgZ(7,"div",17)(8,"label",18),t._uU(9),t.ALo(10,"translate"),t.qZA(),t._UZ(11,"input",46),t.YNc(12,q,2,1,"div",45),t.qZA(),t.TgZ(13,"div",17)(14,"label",18),t._uU(15),t.ALo(16,"translate"),t.qZA(),t._UZ(17,"input",47),t.YNc(18,V,2,1,"div",45),t.qZA(),t.TgZ(19,"div",17)(20,"label",18),t._uU(21),t.ALo(22,"translate"),t.qZA(),t._UZ(23,"input",48),t.YNc(24,R,2,1,"div",45),t.qZA()()),2&e){const o=t.oxw(2);t.xp6(3),t.Oqu(t.lcZ(4,8,"Amazon S3 key")),t.xp6(3),t.Q6J("ngIf",o.localStorageForm.get("amazonS3key").touched&&o.localStorageForm.get("amazonS3key").errors),t.xp6(3),t.Oqu(t.lcZ(10,10,"Amazon S3 secret")),t.xp6(3),t.Q6J("ngIf",o.localStorageForm.get("amazonS3secret").touched&&o.localStorageForm.get("amazonS3secret").errors),t.xp6(3),t.Oqu(t.lcZ(16,12,"Amazon S3 region")),t.xp6(3),t.Q6J("ngIf",o.localStorageForm.get("amazonS3region").touched&&o.localStorageForm.get("amazonS3region").errors),t.xp6(3),t.Oqu(t.lcZ(22,14,"Amazon S3 bucket")),t.xp6(3),t.Q6J("ngIf",o.localStorageForm.get("amazonS3bucket").touched&&o.localStorageForm.get("amazonS3bucket").errors)}}function G(e,r){if(1&e){const o=t.EpF();t.TgZ(0,"mat-tab",39),t.ALo(1,"translate"),t.TgZ(2,"div",14)(3,"div",15)(4,"div",4)(5,"form",16)(6,"div",4)(7,"div",17)(8,"div",8)(9,"label",18),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.TgZ(12,"ng-select",40)(13,"ng-option",41),t._uU(14),t.ALo(15,"translate"),t.qZA(),t.TgZ(16,"ng-option",41),t._uU(17),t.ALo(18,"translate"),t.qZA()()()(),t.YNc(19,O,25,16,"div",42),t.TgZ(20,"div",31)(21,"button",43),t.NdJ("click",function(){t.CHM(o);const i=t.oxw();return t.KtG(i.saveLocalStorage())}),t._UZ(22,"i",33),t._uU(23),t.ALo(24,"translate"),t.qZA(),t.TgZ(25,"button",34),t._UZ(26,"i",35),t._uU(27),t.ALo(28,"translate"),t.qZA()()()()()()()()}if(2&e){const o=t.oxw();t.s9C("label",t.lcZ(1,12,"STORAGE")),t.xp6(5),t.Q6J("formGroup",o.localStorageForm),t.xp6(5),t.Oqu(t.lcZ(11,14,"DEFAULT_STORAGE")),t.xp6(2),t.Q6J("clearable",!1),t.xp6(1),t.Q6J("value","local"),t.xp6(1),t.Oqu(t.lcZ(15,16,"LOCAL")),t.xp6(2),t.Q6J("value","s3"),t.xp6(1),t.Oqu(t.lcZ(18,18,"S3")),t.xp6(2),t.Q6J("ngIf","s3"===o.localStorageForm.get("location").value),t.xp6(4),t.hij(" ",t.lcZ(24,20,"SAVE"),""),t.xp6(2),t.Q6J("routerLink",t.DdM(24,h)),t.xp6(2),t.hij(" ",t.lcZ(28,22,"CANCEL"),"")}}function Q(e,r){1&e&&t._UZ(0,"mat-spinner")}function Y(e,r){if(1&e&&(t.TgZ(0,"div",51),t.YNc(1,Q,1,0,"mat-spinner",45),t.qZA()),2&e){const o=t.oxw();t.xp6(1),t.Q6J("ngIf",o.isLoading)}}let M=(()=>{class e extends y.H{constructor(o,a,i,c,d,ot,et,at){super(),this.route=o,this.fb=a,this.companyProfileService=i,this.router=c,this.toastrService=d,this.securityService=ot,this.translationService=et,this.commonDialogService=at,this.imgSrc="",this.bannerSrc="",this.isLoading=!1}ngOnInit(){this.createform(),this.createLocalStorageform(),this.route.data.subscribe(o=>{this.oldS3Profile=o.s3Profile,this.oldCompanyProfile=o.profile,this.companyProfileForm.patchValue(o.profile),this.localStorageForm.patchValue(o.s3Profile),o.profile.logoUrl&&(this.imgSrc=m.N.apiUrl+o.profile.logoUrl),o.profile.bannerUrl&&(this.bannerSrc=m.N.apiUrl+o.profile.bannerUrl)})}removeRequired(){this.localStorageForm.get("amazonS3key").clearValidators(),this.localStorageForm.get("amazonS3secret").clearValidators(),this.localStorageForm.get("amazonS3region").clearValidators(),this.localStorageForm.get("amazonS3bucket").clearValidators(),this.localStorageForm.get("amazonS3key").updateValueAndValidity(),this.localStorageForm.get("amazonS3secret").updateValueAndValidity(),this.localStorageForm.get("amazonS3region").updateValueAndValidity(),this.localStorageForm.get("amazonS3bucket").updateValueAndValidity()}createform(){this.companyProfileForm=this.fb.group({id:[""],title:["",[l.kI.required]],logoUrl:[""],imageData:[],bannerUrl:[""],bannerData:[""]})}createLocalStorageform(){this.localStorageForm=this.fb.group({id:[""],amazonS3key:["",[l.kI.required]],amazonS3secret:["",[l.kI.required]],amazonS3region:["",[l.kI.required]],amazonS3bucket:["",[l.kI.required]],location:["local"]}),this.localStorageForm.get("location").valueChanges.subscribe(o=>{"local"===o?this.removeRequired():(this.localStorageForm.get("amazonS3key").setValidators([l.kI.required]),this.localStorageForm.get("amazonS3secret").setValidators([l.kI.required]),this.localStorageForm.get("amazonS3region").setValidators([l.kI.required]),this.localStorageForm.get("amazonS3bucket").setValidators([l.kI.required]),this.localStorageForm.get("amazonS3key").updateValueAndValidity(),this.localStorageForm.get("amazonS3secret").updateValueAndValidity(),this.localStorageForm.get("amazonS3region").updateValueAndValidity(),this.localStorageForm.get("amazonS3bucket").updateValueAndValidity())})}saveCompanyProfile(){if(this.companyProfileForm.invalid)return void this.companyProfileForm.markAllAsTouched();const o=this.companyProfileForm.getRawValue();this.isLoading=!0,this.companyProfileService.updateCompanyProfile(o).subscribe(a=>{a.languages&&a.languages.forEach(i=>{i.imageUrl=`${m.N.apiUrl}${i.imageUrl}`}),this.isLoading=!1,this.securityService.updateProfile(a),this.toastrService.success(this.translationService.getValue("COMPANY_PROFILE_UPDATED_SUCCESSFULLY")),this.router.navigate(["dashboard"])},()=>this.isLoading=!1)}saveLocalStorage(){if(this.localStorageForm.invalid)return void this.localStorageForm.markAllAsTouched();const o=this.localStorageForm.getRawValue();"s3"===this.oldCompanyProfile.location&&"s3"===o.location&&this.oldS3Profile!==o?this.commonDialogService.deleteConformationDialog("CHANGE_S3_SETTING_MESSAGE").subscribe(a=>{a&&this.updateStorage(o)}):this.updateStorage(o)}updateStorage(o){this.isLoading=!0,this.companyProfileService.updateLocalStorage(o).subscribe(()=>{this.isLoading=!1,this.oldCompanyProfile.location=o.location,this.securityService.updateProfile(this.oldCompanyProfile),this.toastrService.success(this.translationService.getValue("COMPANY_PROFILE_UPDATED_SUCCESSFULLY")),this.router.navigate(["dashboard"])},()=>{this.isLoading=!1})}onFileSelect(o){const a=o.target.files[0];if(!a||null==a.type.match(/image\/*/))return;const c=new FileReader;c.readAsDataURL(a),c.onload=d=>{this.imgSrc=c.result,this.companyProfileForm.patchValue({imageData:c.result.toString(),logoUrl:a.name}),o.target.value=""}}onBannerChange(o){const a=o.target.files[0];if(!a||null==a.type.match(/image\/*/))return;const c=new FileReader;c.readAsDataURL(a),c.onload=d=>{this.bannerSrc=c.result,this.companyProfileForm.patchValue({bannerData:c.result.toString(),bannerUrl:a.name}),o.target.value=""}}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(s.gz),t.Y36(l.QS),t.Y36(_.V),t.Y36(s.F0),t.Y36(C._W),t.Y36(A.I),t.Y36(Z.D),t.Y36(b.V))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-company-profile"]],features:[t.qOj],decls:16,vars:6,consts:[[1,"content"],[1,"content-block"],[1,"block-header"],[1,"breadcrumb-main"],[1,"row"],[1,"col-6"],[1,"breadcrumb-title"],[1,"row","mt-3"],[1,"col-md-12"],["mat-stretch-tabs","false","mat-align-tabs","start"],["class","nav-tabs",3,"label",4,"hasClaim"],[3,"label",4,"hasClaim"],["class","loading-shade",4,"ngIf"],[1,"nav-tabs",3,"label"],[1,"card","tab-card"],[1,"body"],[3,"formGroup"],[1,"col-md-6"],[1,"form-label"],["formControlName","title","type","text",1,"form-control","w-100"],[1,"col-md-8"],["for",""],[1,"cus-mat-card"],["hidden","","name","logo","type","file","name","Profile Photo","fxFlex","30",3,"change"],["fileInput",""],["class","full-width company-logo",3,"src",4,"ngIf"],["class","full-width company-logo","src","assets/images/logo.png",4,"ngIf"],["type","button",1,"btn","btn-success","btn-sm","mb-2",3,"click"],[1,"far","fa-image"],["fileInput1",""],["class","full-width company-logo","src","assets/images/login-image.png",4,"ngIf"],[1,"m-t-10","col-md-12"],["type","submit","cdkFocusInitial","",1,"btn","btn-success","btn-sm","m-r-10",3,"click"],[1,"fas","fa-save"],["type","button",1,"btn","btn-danger","btn-sm",3,"routerLink"],[1,"fas","fa-times-circle"],[1,"full-width","company-logo",3,"src"],["src","assets/images/logo.png",1,"full-width","company-logo"],["src","assets/images/login-image.png",1,"full-width","company-logo"],[3,"label"],["formControlName","location",3,"clearable"],[3,"value"],["class","row",4,"ngIf"],["type","button","cdkFocusInitial","",1,"btn","btn-success","btn-sm","m-r-10",3,"click"],["formControlName","amazonS3key","type","text",1,"form-control","w-100"],[4,"ngIf"],["formControlName","amazonS3secret","type","text",1,"form-control","w-100"],["formControlName","amazonS3region","type","text",1,"form-control","w-100"],["formControlName","amazonS3bucket","type","text",1,"form-control","w-100"],["class","text-danger",4,"ngIf"],[1,"text-danger"],[1,"loading-shade"]],template:function(o,a){1&o&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"h2"),t._uU(8),t.ALo(9,"translate"),t.qZA()()()()()(),t.TgZ(10,"div",7)(11,"div",8)(12,"mat-tab-group",9),t.YNc(13,I,51,31,"mat-tab",10),t.YNc(14,G,29,25,"mat-tab",11),t.qZA()()()()(),t.YNc(15,Y,2,1,"div",12)),2&o&&(t.xp6(8),t.Oqu(t.lcZ(9,4,"COMPANY_PROFILE")),t.xp6(5),t.Q6J("hasClaim","SETTING_MANAGE_PROFILE"),t.xp6(1),t.Q6J("hasClaim","SETTINGS_STORAGE_SETTINGS"),t.xp6(1),t.Q6J("ngIf",a.isLoading))},dependencies:[S.O5,s.rH,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,x.d,g.a8,g.hq,u.uX,u.SP,v.Ou,p.w9,p.jq,T.X$],styles:[".company-logo[_ngcontent-%COMP%]{padding:10px}"]}),e})();var D=n(319),j=n(1539),w=n(9646),H=n(5698),B=n(6099);const X=[{path:"",component:M,data:{claimType:["SETTING_MANAGE_PROFILE","SETTINGS_STORAGE_SETTINGS"]},canActivate:[D.a],resolve:{profile:j.X,s3Profile:(()=>{class e{constructor(o,a){this.companyProfileService=o,this.router=a}resolve(o,a){return this.companyProfileService.getS3Config().pipe((0,H.q)(1),(0,B.z)(i=>i?(0,w.of)(i):(this.router.navigate(["/dashboard"]),null)))}}return e.\u0275fac=function(o){return new(o||e)(t.LFG(_.V),t.LFG(s.F0))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}];let W=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[s.Bz.forChild(X),s.Bz]}),e})();var $=n(3417);let tt=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[S.ez,W,$.m,l.UX,g.QW,u.Nh,v.Cq,p.A0]}),e})()}}]);