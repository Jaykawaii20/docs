"use strict";(self.webpackChunkdocument_management=self.webpackChunkdocument_management||[]).push([[578],{1312:(D,d,o)=>{o.d(d,{E:()=>l});class l{constructor(){this.totalCount=0,this.pageSize=0,this.skip=0,this.totalPages=0}}},4913:(D,d,o)=>{o.d(d,{J:()=>m});var l=o(5519);class m extends l.r{constructor(){super(...arguments),this.id="",this.createdBy="",this.categoryId="",this.location="",this.deletedBy=""}}},2760:(D,d,o)=>{o.d(d,{c:()=>m});const m=[{id:0,name:"Daily"},{id:1,name:"Weekly"},{id:2,name:"Monthly"},{id:3,name:"Quarterly"},{id:4,name:"HalfYearly"},{id:5,name:"Yearly"}]},5519:(D,d,o)=>{o.d(d,{r:()=>l});class l{constructor(){this.fields="",this.orderBy="",this.searchQuery="",this.pageSize=30,this.skip=0,this.name="",this.totalCount=0,this.metaTags=""}}},6943:(D,d,o)=>{o.d(d,{H:()=>A});var l=o(262),m=o(4650),g=o(529),C=o(8032);let A=(()=>{class v{constructor(a,p){this.httpClient=a,this.commonHttpErrorService=p}getAllCategories(){return this.httpClient.get("category")}delete(a){return this.httpClient.delete(`category/${a}`)}update(a){return this.httpClient.put(`category/${a.id}`,a)}add(a){return this.httpClient.post("category",a).pipe((0,l.K)(this.commonHttpErrorService.handleError))}getSubCategories(a){return this.httpClient.get(`category/${a}/subcategories`)}getAllCategoriesForDropDown(){return this.httpClient.get("category/dropdown")}}return v.\u0275fac=function(a){return new(a||v)(m.LFG(g.eN),m.LFG(C.U))},v.\u0275prov=m.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"}),v})()},690:(D,d,o)=>{o.d(d,{v:()=>_});var l=o(529),m=o(9646),g=o(262),C=o(2760),A=o(4650),v=o(8032);let _=(()=>{class a{constructor(i,c){this.httpClient=i,this.commonHttpErrorService=c}getUsers(){return this.httpClient.get("user").pipe((0,g.K)(this.commonHttpErrorService.handleError))}getUsersForDropdown(){return this.httpClient.get("user-dropdown").pipe((0,g.K)(this.commonHttpErrorService.handleError))}getRoles(){return this.httpClient.get("role").pipe((0,g.K)(this.commonHttpErrorService.handleError))}getRolesForDropdown(){return this.httpClient.get("role-dropdown").pipe((0,g.K)(this.commonHttpErrorService.handleError))}getMyReminder(i){return this.httpClient.get(`reminder/${i}/myreminder`).pipe((0,g.K)(this.commonHttpErrorService.handleError))}getReminder(i){return this.httpClient.get(`reminder/${i}`).pipe((0,g.K)(this.commonHttpErrorService.handleError))}addDocumentAuditTrail(i){return this.httpClient.post("documentAuditTrail",i).pipe((0,g.K)(this.commonHttpErrorService.handleError))}downloadDocument(i,c){return this.httpClient.get(`document/${i}/download/${c} `,{reportProgress:!0,observe:"events",responseType:"blob"})}isDownloadFlag(i,c){return this.httpClient.get(`document/${i}/isDownloadFlag/isPermission/${c}`)}getDocumentToken(i){return this.httpClient.get(`documentToken/${i}/token`)}deleteDocumentToken(i){return this.httpClient.delete(`documentToken/${i}`)}readDocument(i,c){return this.httpClient.get(`document/${i}/readText/${c}`)}getReminderFrequency(){return(0,m.of)(C.c)}getAllRemindersForCurrentUser(i){const f=(new l.LE).set("fields",i.fields?i.fields:"").set("orderBy",i.orderBy?i.orderBy:"").set("pageSize",i.pageSize.toString()).set("skip",i.skip.toString()).set("searchQuery",i.searchQuery?i.searchQuery:"").set("subject",i.subject?i.subject:"").set("message",i.message?i.message:"").set("frequency",i.frequency?i.frequency:"");return this.httpClient.get("reminder/all/currentuser",{params:f,observe:"response"})}deleteReminderCurrentUser(i){return this.httpClient.delete(`reminder/currentuser/${i}`)}}return a.\u0275fac=function(i){return new(i||a)(A.LFG(l.eN),A.LFG(v.U))},a.\u0275prov=A.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})()},8578:(D,d,o)=>{o.r(d),o.d(d,{DocumentAuditTrailModule:()=>Tt});var l=o(6895),m=o(8988),g=o(319),C=o(8739),A=o(6308),v=o(4913),_=o(6451),a=o(4968),p=o(8505),i=o(8372),c=o(1884),f=o(2676),U=o(1312),S=o(1135),O=o(9646),E=o(262),L=o(8746);class N{get count(){return this._count}constructor(r){this.documentAuditTrailService=r,this.documentAuditTrailsSubject=new S.X([]),this.responseHeaderSubject=new S.X(null),this.loadingSubject=new S.X(!1),this.loading$=this.loadingSubject.asObservable(),this._count=0,this.responseHeaderSubject$=this.responseHeaderSubject.asObservable()}connect(r){return this.documentAuditTrailsSubject.asObservable()}disconnect(r){this.documentAuditTrailsSubject.complete(),this.loadingSubject.complete()}loadDocumentAuditTrails(r){this.loadingSubject.next(!0),this.documentAuditTrailService.getDocumentAuditTrials(r).pipe((0,E.K)(()=>(0,O.of)([])),(0,L.x)(()=>this.loadingSubject.next(!1))).subscribe(n=>{const s=new U.E;s.pageSize=parseInt(n.headers.get("pageSize")),s.totalCount=parseInt(n.headers.get("totalCount")),s.skip=parseInt(n.headers.get("skip")),this.responseHeaderSubject.next(s);const u=[...n.body];this._count=u.length,this.documentAuditTrailsSubject.next(u)})}}var t=o(4650),Z=o(529),M=o(8032);let I=(()=>{class e{constructor(n,s){this.httpClient=n,this.commonHttpErrorService=s}getDocumentAuditTrials(n){const u=(new Z.LE).set("fields",n.fields).set("orderBy",n.orderBy).set("pageSize",n.pageSize.toString()).set("skip",n.skip.toString()).set("searchQuery",n.searchQuery).set("categoryId",n.categoryId).set("name",n.name).set("id",n.id.toString()).set("createdBy",n.createdBy.toString());return this.httpClient.get("documentAuditTrail",{params:u,observe:"response"}).pipe((0,E.K)(this.commonHttpErrorService.handleError))}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(Z.eN),t.LFG(M.U))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var B=o(6943),j=o(690),b=o(6107),T=o(671),R=o(1572),y=o(8796),x=o(9383),Y=o(8017);const $=["input"];function H(e,r){if(1&e&&(t.TgZ(0,"div")(1,"b"),t._uU(2),t.qZA()()),2&e){const n=t.oxw().$implicit;t.xp6(2),t.hij(" ",n.name,"")}}function Q(e,r){if(1&e&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.hij(" ",n.name," ")}}const F=function(e){return{"margin-right.px":e}},z=function(e){return{"margin-left.px":e}};function K(e,r){if(1&e&&(t.TgZ(0,"ng-option",34)(1,"div",35),t.YNc(2,H,3,1,"div",31),t.YNc(3,Q,2,1,"div",31),t.qZA()()),2&e){const n=r.$implicit,s=t.oxw();t.Q6J("value",n.id),t.xp6(1),t.Q6J("ngStyle","rtl"===s.direction?t.VKq(4,F,20*n.deafLevel):t.VKq(6,z,20*n.deafLevel)),t.xp6(1),t.Q6J("ngIf",!n.parentId),t.xp6(1),t.Q6J("ngIf",n.parentId)}}function P(e,r){if(1&e&&(t.TgZ(0,"ng-option",34),t._uU(1),t.qZA()),2&e){const n=r.$implicit;t.Q6J("value",n.id),t.xp6(1),t.AsE(" ",n.firstName," ",n.lastName," ")}}function J(e,r){1&e&&(t.TgZ(0,"th",36),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"NAME")," "))}function W(e,r){if(1&e&&(t.TgZ(0,"td",37),t._uU(1),t.qZA()),2&e){const n=r.$implicit;t.xp6(1),t.hij(" ",n.documentName," ")}}function w(e,r){1&e&&(t.TgZ(0,"th",36),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"CATEGORY_NAME")," "))}function G(e,r){if(1&e&&(t.TgZ(0,"td",37),t._uU(1),t.qZA()),2&e){const n=r.$implicit;t.xp6(1),t.hij(" ",n.categoryName," ")}}function k(e,r){1&e&&(t.TgZ(0,"th",36),t._uU(1),t.ALo(2,"translate"),t.ALo(3,"translate"),t.qZA()),2&e&&(t.xp6(1),t.AsE(" ",t.lcZ(2,2,"ACTION")," ",t.lcZ(3,4,"DATE"),""))}function X(e,r){if(1&e&&(t.TgZ(0,"td",37),t._uU(1),t.ALo(2,"utcToLocalTime"),t.qZA()),2&e){const n=r.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,null==n?null:n.createdDate,"short")," ")}}function V(e,r){1&e&&(t.TgZ(0,"th",36),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"OPERATION")," "))}function q(e,r){if(1&e&&(t.TgZ(0,"td",37),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e){const n=r.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,n.operationName.toUpperCase())," ")}}function tt(e,r){1&e&&(t.TgZ(0,"th",36),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"BY_WHOM")," "))}function et(e,r){if(1&e&&(t.TgZ(0,"td",37),t._uU(1),t.qZA()),2&e){const n=r.$implicit;t.xp6(1),t.hij(" ",null==n?null:n.createdBy," ")}}function nt(e,r){1&e&&(t.TgZ(0,"th",36),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"TO_WHOM_USER")," "))}function ot(e,r){if(1&e&&(t.TgZ(0,"td",37),t._uU(1),t.qZA()),2&e){const n=r.$implicit;t.xp6(1),t.hij(" ",null==n?null:n.permissionUser," ")}}function it(e,r){1&e&&(t.TgZ(0,"th",36),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"TO_WHOM_ROLE")," "))}function rt(e,r){if(1&e&&(t.TgZ(0,"td",37),t._uU(1),t.qZA()),2&e){const n=r.$implicit;t.xp6(1),t.hij(" ",null==n?null:n.permissionRole," ")}}function st(e,r){1&e&&t._UZ(0,"tr",38)}function at(e,r){1&e&&t._UZ(0,"tr",39)}function ct(e,r){1&e&&(t.ynx(0),t.TgZ(1,"div",40)(2,"strong"),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.BQk()),2&e&&(t.xp6(3),t.Oqu(t.lcZ(4,1,"NO_DATA_FOUND")))}function ut(e,r){1&e&&(t.TgZ(0,"div",41),t._UZ(1,"mat-spinner"),t.qZA())}const lt=function(){return[10,20,30]},dt=[{path:"",component:(()=>{class e extends f.H{constructor(n,s,u,h){super(),this.documentAuditTrailService=n,this.categoryService=s,this.commonService=u,this.translationService=h,this.documentAuditTrails=[],this.displayedColumns=["createdDate","documentName","categoryName","operationName","createdBy","permissionUser","permissionRole"],this.isLoadingResults=!0,this.categories=[],this.allCategories=[],this.users=[],this.documentResource=new v.J,this.documentResource.pageSize=10,this.documentResource.orderBy="createdDate desc"}ngOnInit(){this.dataSource=new N(this.documentAuditTrailService),this.dataSource.loadDocumentAuditTrails(this.documentResource),this.getCategories(),this.getResourceParameter(),this.getUsers(),this.getLangDir()}getLangDir(){this.sub$.sink=this.translationService.lanDir$.subscribe(n=>this.direction=n)}ngAfterViewInit(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),this.sub$.sink=(0,_.T)(this.sort.sortChange,this.paginator.page).pipe((0,p.b)(()=>{this.documentResource.skip=this.paginator.pageIndex*this.paginator.pageSize,this.documentResource.pageSize=this.paginator.pageSize,this.documentResource.orderBy=this.sort.active+" "+this.sort.direction,this.dataSource.loadDocumentAuditTrails(this.documentResource)})).subscribe(),this.sub$.sink=(0,a.R)(this.input.nativeElement,"keyup").pipe((0,i.b)(1e3),(0,c.x)(),(0,p.b)(()=>{this.paginator.pageIndex=0,this.documentResource.skip=0,this.documentResource.name=this.input.nativeElement.value,this.dataSource.loadDocumentAuditTrails(this.documentResource)})).subscribe()}onCategoryChange(n){this.documentResource.categoryId=n||"",this.documentResource.skip=0,this.paginator.pageIndex=0,this.dataSource.loadDocumentAuditTrails(this.documentResource)}onUserChange(n){this.documentResource.createdBy=n||"",this.documentResource.skip=0,this.paginator.pageIndex=0,this.dataSource.loadDocumentAuditTrails(this.documentResource)}getCategories(){this.categoryService.getAllCategoriesForDropDown().subscribe(n=>{this.categories=n,this.setDeafLevel()})}setDeafLevel(n,s){const u=this.categories.filter(h=>h.parentId==s);return u.length>0&&u.map((h,At)=>{h.deafLevel=n?n.deafLevel+1:0,h.index=(n?n.index:0)+At*Math.pow(.1,h.deafLevel),this.allCategories.push(h),this.setDeafLevel(h,h.id)}),n}getUsers(){this.sub$.sink=this.commonService.getUsersForDropdown().subscribe(n=>{this.users=n},n=>{n.messages.forEach(()=>{})})}getResourceParameter(){this.sub$.sink=this.dataSource.responseHeaderSubject$.subscribe(n=>{n&&(this.documentResource.pageSize=n.pageSize,this.documentResource.skip=n.skip,this.documentResource.totalCount=n.totalCount)})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(I),t.Y36(B.H),t.Y36(j.v),t.Y36(b.D))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-document-audit-trail"]],viewQuery:function(n,s){if(1&n&&(t.Gf(C.NW,5),t.Gf(A.YE,5),t.Gf($,5)),2&n){let u;t.iGM(u=t.CRH())&&(s.paginator=u.first),t.iGM(u=t.CRH())&&(s.sort=u.first),t.iGM(u=t.CRH())&&(s.input=u.first)}},features:[t.qOj],decls:67,vars:35,consts:[[1,"content"],[1,"content-block"],[1,"block-header"],[1,"breadcrumb-main"],[1,"row"],[1,"col-6"],[1,"breadcrumb-title"],[1,"col-xl-12","col-lg-12","col-md-12","col-sm-12"],[1,"card"],[1,"body"],[1,"row","margin-2"],[1,"col-md-4"],[1,"form-label"],[1,"form-control",3,"placeholder"],["input",""],[3,"placeholder","change"],[3,"value",4,"ngFor","ngForOf"],[1,"col"],[1,"table-responsive"],["mat-table","","matSort","","matSortActive","createdDate","matSortDirection","desc","matSortDisableClear","",1,"w-100",3,"dataSource"],["matColumnDef","documentName"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","categoryName"],["matColumnDef","createdDate"],["matColumnDef","operationName"],["matColumnDef","createdBy"],["matColumnDef","permissionUser"],["matColumnDef","permissionRole"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],[4,"ngIf"],[3,"length","pageSize","pageSizeOptions"],["class","loading-shade",4,"ngIf"],[3,"value"],[1,"country-item",3,"ngStyle"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-row",""],["mat-row",""],[1,"col-sm-12","m-t-15"],[1,"loading-shade"]],template:function(n,s){1&n&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"h2"),t._uU(8),t.ALo(9,"translate"),t.qZA()()()()()(),t.TgZ(10,"div",4)(11,"div",7)(12,"div",8)(13,"div",9)(14,"div",10)(15,"div",11)(16,"label",12),t._uU(17),t.ALo(18,"translate"),t.qZA(),t._UZ(19,"input",13,14),t.ALo(21,"translate"),t.qZA(),t.TgZ(22,"div",11)(23,"label",12),t._uU(24),t.ALo(25,"translate"),t.qZA(),t.TgZ(26,"ng-select",15),t.NdJ("change",function(h){return s.onCategoryChange(h)}),t.ALo(27,"translate"),t.YNc(28,K,4,8,"ng-option",16),t.qZA()(),t.TgZ(29,"div",11)(30,"label",12),t._uU(31),t.ALo(32,"translate"),t.qZA(),t.TgZ(33,"ng-select",15),t.NdJ("change",function(h){return s.onUserChange(h)}),t.ALo(34,"translate"),t.YNc(35,P,2,3,"ng-option",16),t.qZA()()(),t.TgZ(36,"div",4)(37,"div",17)(38,"div",18)(39,"table",19),t.ynx(40,20),t.YNc(41,J,3,3,"th",21),t.YNc(42,W,2,1,"td",22),t.BQk(),t.ynx(43,23),t.YNc(44,w,3,3,"th",21),t.YNc(45,G,2,1,"td",22),t.BQk(),t.ynx(46,24),t.YNc(47,k,4,6,"th",21),t.YNc(48,X,3,4,"td",22),t.BQk(),t.ynx(49,25),t.YNc(50,V,3,3,"th",21),t.YNc(51,q,3,3,"td",22),t.BQk(),t.ynx(52,26),t.YNc(53,tt,3,3,"th",21),t.YNc(54,et,2,1,"td",22),t.BQk(),t.ynx(55,27),t.YNc(56,nt,3,3,"th",21),t.YNc(57,ot,2,1,"td",22),t.BQk(),t.ynx(58,28),t.YNc(59,it,3,3,"th",21),t.YNc(60,rt,2,1,"td",22),t.BQk(),t.YNc(61,st,1,0,"tr",29),t.YNc(62,at,1,0,"tr",30),t.qZA(),t.YNc(63,ct,5,3,"ng-container",31),t._UZ(64,"mat-paginator",32),t.qZA()()()()()()()()(),t.YNc(65,ut,2,0,"div",33),t.ALo(66,"async")),2&n&&(t.xp6(8),t.Oqu(t.lcZ(9,18,"DOCUMENTS_AUDIT_TRAIL")),t.xp6(9),t.Oqu(t.lcZ(18,20,"SEARCH_DOCUMENT_BY_NAME")),t.xp6(2),t.s9C("placeholder",t.lcZ(21,22,"SEARCH_DOCUMENT_BY_NAME")),t.xp6(5),t.Oqu(t.lcZ(25,24,"SELECT_CATEGORY")),t.xp6(2),t.s9C("placeholder",t.lcZ(27,26,"CATEGORY")),t.xp6(2),t.Q6J("ngForOf",s.allCategories),t.xp6(3),t.Oqu(t.lcZ(32,28,"SELECT_USER")),t.xp6(2),t.s9C("placeholder",t.lcZ(34,30,"SELECT_USER")),t.xp6(2),t.Q6J("ngForOf",s.users),t.xp6(4),t.Q6J("dataSource",s.dataSource),t.xp6(22),t.Q6J("matHeaderRowDef",s.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",s.displayedColumns),t.xp6(1),t.Q6J("ngIf",0===s.dataSource.count),t.xp6(1),t.Q6J("length",s.documentResource.totalCount)("pageSize",s.documentResource.pageSize)("pageSizeOptions",t.DdM(34,lt)),t.xp6(1),t.Q6J("ngIf",t.lcZ(66,32,s.dataSource.loading$)))},dependencies:[l.sg,l.O5,l.PC,T.BZ,T.fO,T.as,T.w1,T.Dz,T.nj,T.ge,T.ev,T.XQ,T.Gk,R.Ou,A.YE,A.nU,C.NW,y.w9,y.jq,l.Ov,x.X$,Y.M]}),e})(),data:{claimType:"DOCUMENT_AUDIT_TRAIL_VIEW_DOCUMENT_AUDIT_TRAIL"},canActivate:[g.a]}];let mt=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[m.Bz.forChild(dt),m.Bz]}),e})();var pt=o(4144),ht=o(455),gt=o(4586);let Tt=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[l.ez,mt,T.p0,R.Cq,ht.rP,A.JX,C.TU,pt.c,x.aw,y.A0,gt.D]}),e})()}}]);